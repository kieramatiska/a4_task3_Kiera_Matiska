---
title: "Bonanza Snowshoe Hares"
author: "Kiera Matiska"
date: "11/5/2021"
output: 
  html_document: 
    toc: yes
    theme: cerulean
    number_sections: yes
    code_folding: hide
---
# Introduction

# Data and Analyses

## Citations

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Attach Packages
library(tidyverse)
library(here)
library(lubridate)
library(kableExtra)
```

# Read in data

- Use `read_csv()` and the here package to read in bonanza_hares.csv.

```{r}
hares <- read_csv(here("data", "bonanza_hares.csv"))
```

# Annual Juvinile Hare Trap Counts

# Data Wrangling

- Create a new column, year, using the `year()` function in lubridate
- Create a subset that only contains juvenile hare data
- Create a new data frame using the `summarize()` function that has two columns, year and number of hare traps
- Use `kable_styling()` to finalize the table

```{r}
hares_year <- hares %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date))

hares_juvenile <- hares_year %>% 
  filter(age == "j")

hares_traps <- hares_juvenile %>% 
  select(year, age) %>% 
  group_by(year) %>% 
  summarize(number = n())

hares_traps %>% 
  kbl() %>% 
  kable_styling()
```

## Visualize Data

Create a column graph using `ggplot()`

```{r}
ggplot(data = hares_traps, 
       aes(x = year, y = number)) +
  geom_col(color = "gray", fill = "darkblue") +
  scale_x_continuous(breaks = 1999:2012) +
  theme_gray() +
  labs(title = "Juvenile Hare Trap Counts Per Year",
       x = "Year",
       y = "Number of Traps",
       caption = expression(
         paste(
           bold("Figure 1."), " Annual Counts of Juvenile Hare Traps in Bonanza Creek"))) +
  theme(plot.title = element_text(hjust = 0.5), 
        plot.caption = element_text(hjust = 0))
```

Figure 1: Annual Counts of Juvenile Hare Traps in Bonanza Creek

## Major Takeaways

# Juvenile Hare Weights

## Data Wrangling

- Using `mutate()`, rename the sex variables so they are spelled out: m = male, f = female, and NA = not applicable
- Using `mutate()`, reame the grid variables so they are spelled out: bonrip = Bonanza Riparian, bonmat = Bonanza Mature, bonbs = Bonanza Lowland Mature
- Create new data frame, hare_weights, using the `select()` function so that it contains only hare weights, sex, and grid site.

```{r}
hares_sex <- hares_juvenile %>% 
  mutate(sex = case_when(
    sex == "m" ~ "male",
    sex == "f" ~ "female",
    is.na(sex) == TRUE ~ "N/A"
  ))

hare_grids <- hares_sex %>% 
  mutate(grid = case_when(
    grid == "bonrip" ~ "Bonanza Riparian",
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonbs" ~ "Bonanza Lowland Mature"
  ))

hare_weights <- hare_grids %>% 
  select(weight, sex, grid)
```

## Data Visualization

Create a graph of the hare_weights data:
- Facet by sex
- Change label names
- Add a figure caption

```{r}
ggplot(data = hare_weights,
       aes(x = sex, y = weight)) +
  geom_point(size = 0.8, aes(color = sex)) +
  facet_grid(~ grid) +
  labs(title = "Juvenile Hare Weights by Sex in Each Site Zone",
       x = "Sex",
       y = "Weight (g)",
       caption = expression(
         paste(
           bold("Figure 2."), " Juvenile Hare Weights (g) by Sex in Each Bonanza Creek Site Zone"
         )
       )) +
  theme(plot.title = element_text(hjust = 0.5), 
        legend.position = "none",
        plot.caption = element_text(hjust = 0))
```

## Major Takeaways

# Juvenile Weight Comparisons (male and female snowshoe hares)

## Wrangle Data

Create a data subset, `weight_hare` with only the variables sex and weight

```{r}
weight_hare <- hares_sex %>% 
  select(sex, weight) %>% 
  filter(sex %in% c("male", "female"))
```

## Summarize Data

Create and finalize a summary table that contains the mean, standard deviation, and sample size for male and female juvenile hares
- Use the `summarize` and `group_by` functions to find weight statistics based on sex
- Use `kableExtra` to finalize table and add table caption

```{r}
hare_summary <- weight_hare %>% 
  group_by(sex) %>% 
  summarize(mean(weight),
            sd(weight),
            sample_size = n())

hare_summary %>% 
  kbl(caption = "Caption 1: Mean, Standard Deviation, and Sample Sizes of Weights by Sex of Juvenile Hares") %>% 
  kable_styling()
```

